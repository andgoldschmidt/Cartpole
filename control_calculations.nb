(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     58405,       1557]
NotebookOptionsPosition[     53613,       1474]
NotebookOutlinePosition[     54067,       1492]
CellTagsIndexPosition[     54024,       1489]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", " ", "m", ",", "M", ",", "l", ",", "g"}], 
       "}"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Element", "[", 
        RowBox[{"#", ",", "Reals"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", "m", ",", "M", ",", "l", ",", "g"}], "}"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.775837578071662*^9, 3.775837598657139*^9}, {
  3.7758376539506807`*^9, 3.7758376583567247`*^9}, {3.775941453700665*^9, 
  3.775941458925927*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"430e562f-2b6c-4ec0-9302-4186201297f2"],

Cell[TextData[{
 "Define the Hamiltonian for the cartpole system. This can be obtained by \
solving the Lagrangian for the system and changing coordinates using the \
Laplace transform. The Lagrangian is Problem 5.2 in Landau\[CloseCurlyQuote]s \
Mechanics. It\[CloseCurlyQuote]s  also fine to use the Lagrangian equations \
of motion by choosing x,",
 Cell[BoxData[
  FormBox[
   OverscriptBox["x", "."], TraditionalForm]],ExpressionUUID->
  "d566b4f4-698a-4dd8-96d4-fd157ac31115"],
 ",\[Theta],",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Theta]", "."], TraditionalForm]],ExpressionUUID->
  "6e07c9c2-3a83-4afa-b068-1337f16c7423"],
 " as your coordinates allowed on the right hand side of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["dX", "dt"], "=", 
    RowBox[{"f", "(", 
     RowBox[{"x", ",", 
      FormBox[
       OverscriptBox["x", "."],
       TraditionalForm], ",", "\[Theta]", ",", 
      FormBox[
       OverscriptBox["\[Theta]", "."],
       TraditionalForm]}]}]}], TraditionalForm]],ExpressionUUID->
  "a43d7438-d29a-4923-959c-efc2af61adb6"],
 "). Note that this will exclude the phase-space interpretation and Liouville\
\[CloseCurlyQuote]s equation.\n[  Solution, for an angle defined from the \
upright position: L = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{"M", "+", "m"}], ")"}], 
     SuperscriptBox[
      OverscriptBox["x", "."], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     SuperscriptBox["ml", "2"], 
     SuperscriptBox[
      OverscriptBox["\[Theta]", "."], "2"]}], "+", 
    RowBox[{"m", " ", "l", " ", 
     OverscriptBox["x", "."], 
     OverscriptBox["\[Theta]", "."], " ", "cos\[Theta]"}], "-", 
    RowBox[{"m", " ", "g", " ", "l", " ", "cos\[Theta]"}]}], 
   TraditionalForm]],ExpressionUUID->"964184ec-0ac0-4fe5-a087-93d79a824150"],
 "  ]\nThe StateL and StateH are the respective right hand sides of the \
equations of motion for the relevant variables.\nTo include a dissipative \
force on the cart and an external forcing on the cart, the Euler-Lagrange \
equations must be derived first. Then, force terms can be added to the right \
hand side (See Landau for why external forcing is times x and damping is \
times ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["x", "."], TraditionalForm]],ExpressionUUID->
  "fe714c1e-5923-4741-8e94-f19d989cd793"],
 " within the framework. See Goldstein for a discussion of external forcing \
appearing after the equations of motion have been written.).\nNote: We\
\[CloseCurlyQuote]ll keep x, xdot, \[Theta], \[Theta]dot as undefined \
variables (to nicely print equations)."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvWfP28PRim8c3falnwTRHUyuZo+BNHftgigQPadc
NAFE95qlJ4LorM5T5SB6TbB5JYje0PakAUS/fdoxD0RfuDJ9EYjeUiG3BES7
TPpxm1XpjeMfE6knIFpixjxJNiA95+1sKRAtkT17FYhWa7gDpn+/jD4Lotf+
mgCmdTtXmrADabHOZ5Yg2s+dMx5EuzyPTgTRfS/VL4DozSa6YNpqev1DEP1s
UxuYzuavP88BpG9XNV0C0Ubaso6cQDrs9ydnEH359jV3EH2w95sviO7Nc9hR
pQyk/4nvBNHfym2ugeiKXI07IDqn8ukXEL1tEdtPEA0AvtuZZA==
  
  "],ExpressionUUID->"ea78d738-7d98-4393-9e5e-568137be42bc"],

Cell[CellGroupData[{

Cell["Lagrangian formulation", "Subsection",
 CellChangeTimes->{{3.775936119133642*^9, 
  3.775936122787771*^9}},ExpressionUUID->"8ee5324f-d8cd-4a8b-a841-\
d26519466c10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]", "[", 
   RowBox[{"x_", ",", "xdot_", ",", "\[Theta]_", ",", "\[Theta]dot_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"M", "+", "m"}], ")"}], 
    SuperscriptBox["xdot", "2"]}], "+", 
   FractionBox[
    RowBox[{"m", " ", 
     SuperscriptBox["l", "2"], " ", 
     SuperscriptBox["\[Theta]dot", "2"]}], "2"], "+", " ", 
   RowBox[{"m", " ", "l", " ", "xdot", " ", "\[Theta]dot", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
   RowBox[{"m", " ", "g", " ", "l", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.775934251374908*^9, 3.775934352908889*^9}, {
   3.775934411736392*^9, 3.775934453408308*^9}, 3.7759344872470217`*^9, {
   3.7759345647832413`*^9, 3.77593457385142*^9}, 3.7759379583353662`*^9, {
   3.77593817353185*^9, 3.775938173732534*^9}, 3.775938308121193*^9, 
   3.775938437975033*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"0773fa27-68e4-4548-9646-fc0005e7688d"],

Cell[TextData[{
 "Note that in the Lagrange formulation, we don\[CloseCurlyQuote]t have an \
explicit first-order differential equation, and therefore need to do a bit of \
work:  invert the matrix A(",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ",", 
    FormBox[
     OverscriptBox["x", "."],
     TraditionalForm], ",", "\[Theta]", ",", 
    FormBox[
     OverscriptBox["\[Theta]", "."],
     TraditionalForm]}], TraditionalForm]],ExpressionUUID->
  "0b4c1a9f-92f0-4603-a474-6c0fbfc4cc1e"],
 ") in front of (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FormBox[
     OverscriptBox[
      RowBox[{"x", ","}], ".."],
     TraditionalForm], 
    FormBox[
     OverscriptBox["\[Theta]", ".."],
     TraditionalForm]}], TraditionalForm]],ExpressionUUID->
  "6df5b495-a91f-4306-b4da-9f067bc23345"],
 ") to get the dynamics for the velocities. Note the dynamics for the \
positions are just the velocities."
}], "Text",
 CellChangeTimes->{{3.775936342058558*^9, 3.775936414803976*^9}, {
  3.7759371589165783`*^9, 3.775937215386828*^9}, {3.775938604622361*^9, 
  3.775938610064455*^9}},ExpressionUUID->"a0ce988f-67a9-47bf-b257-\
3eb1dce7150a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]], 
             RowBox[{"(", 
              RowBox[{"\[ScriptCapitalL]", "[", 
               RowBox[{
                RowBox[{"x", "[", "t", "]"}], ",", 
                RowBox[{
                 RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
                RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
                RowBox[{
                 RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ")"}]}],
             ",", "t"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["\[PartialD]", 
            RowBox[{"\[Theta]", "[", "t", "]"}]], 
           RowBox[{"(", 
            RowBox[{"\[ScriptCapitalL]", "[", 
             RowBox[{
              RowBox[{"x", "[", "t", "]"}], ",", 
              RowBox[{
               RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
              RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ")"}]}]}],
          "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{
               RowBox[{"x", "'"}], "[", "t", "]"}]], 
             RowBox[{"(", 
              RowBox[{"\[ScriptCapitalL]", "[", 
               RowBox[{
                RowBox[{"x", "[", "t", "]"}], ",", 
                RowBox[{
                 RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
                RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
                RowBox[{
                 RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ")"}]}],
             ",", "t"}], "]"}], "-", 
          RowBox[{
           SubscriptBox["\[PartialD]", 
            RowBox[{"x", "[", "t", "]"}]], 
           RowBox[{"(", 
            RowBox[{"\[ScriptCapitalL]", "[", 
             RowBox[{
              RowBox[{"x", "[", "t", "]"}], ",", 
              RowBox[{
               RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
              RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ")"}]}]}],
          "\[Equal]", 
         RowBox[{
          RowBox[{"F", "[", "t", "]"}], "-", 
          RowBox[{"\[Eta]", " ", 
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}]}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "''"}], "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"x", "''"}], "[", "t", "]"}]}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], "\[Rule]", "x"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", "xdot"}], ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", 
       "\[Theta]dot"}]}], "}"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{
  3.7759346863258533`*^9, 3.775934809950899*^9, {3.7759348580498343`*^9, 
   3.775934866509536*^9}, {3.775934903885578*^9, 3.775934976654516*^9}, {
   3.775935178909828*^9, 3.775935197073056*^9}, {3.775935237351697*^9, 
   3.77593524419534*^9}, {3.775935288450218*^9, 3.775935289443563*^9}, {
   3.7759353255090027`*^9, 3.775935333697463*^9}, {3.775935366968956*^9, 
   3.775935393258623*^9}, 3.77593783334671*^9, {3.775938364799902*^9, 
   3.775938421915859*^9}, 3.7759386281025*^9, {3.775938775353187*^9, 
   3.775938834787753*^9}, {3.775938932657848*^9, 3.77593893522718*^9}, 
   3.775939535005597*^9, {3.77669844047397*^9, 3.776698440870323*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"3cd99b9c-cd7f-4c30-9544-2252376c4807"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"F", "[", "t", "]"}]}], "-", 
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xdot"}], " ", "\[Eta]"}], "+", 
           RowBox[{"l", " ", "m", " ", 
            SuperscriptBox["\[Theta]dot", "2"], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
       RowBox[{"l", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M", "-", 
          RowBox[{"m", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}]}], 
    ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "xdot"}], " ", "\[Eta]"}], "+", 
       RowBox[{"F", "[", "t", "]"}], "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l", " ", 
           SuperscriptBox["\[Theta]dot", "2"]}], "-", 
          RowBox[{"g", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{"m", "+", "M", "-", 
       RowBox[{"m", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.775935247205768*^9, {3.775935329805531*^9, 3.775935334034494*^9}, 
   3.775935460589508*^9, 3.7759369880623617`*^9, 3.775937843740653*^9, 
   3.775938184097624*^9, 3.775938320894614*^9, {3.775938388699901*^9, 
   3.7759384228757668`*^9}, 3.775938629014176*^9, 3.775938781181457*^9, 
   3.77593953592988*^9, {3.776697804580583*^9, 3.776697824820425*^9}, 
   3.776698441561988*^9, 3.776699298744578*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"056998f0-5e4a-4a11-a3e9-0b4472ff4f84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"StateL", "[", 
   RowBox[{"x_", ",", "xdot_", ",", "\[Theta]_", ",", "\[Theta]dot_"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xdot", ",", 
     RowBox[{
      SuperscriptBox["x", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], ",", "\[Theta]dot", ",", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "}"}], "/.", 
   RowBox[{"res", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StateL", "[", 
   RowBox[{"x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}], 
   "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.775936307000317*^9, 3.775936323542637*^9}, {
   3.775936454071474*^9, 3.775936529757825*^9}, {3.775936580652837*^9, 
   3.775936609330327*^9}, {3.7759366815650473`*^9, 3.77593670554818*^9}, {
   3.7759368949371433`*^9, 3.775936897307596*^9}, {3.775937023655361*^9, 
   3.77593705499265*^9}, {3.775938477275908*^9, 3.775938482669558*^9}, {
   3.77593866030339*^9, 3.775938665345448*^9}, 3.775938797231805*^9, 
   3.775938839163204*^9, {3.7759395818762617`*^9, 3.77593961677668*^9}, {
   3.776698454540839*^9, 3.7766985064020443`*^9}, {3.776698564894003*^9, 
   3.776698569574401*^9}, 3.776698602603868*^9, {3.776699265583909*^9, 
   3.7766992693885183`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"a5a25a67-e544-4067-b9ec-898e2a7842e4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"xdot"},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "xdot"}], " ", "\[Eta]"}], "+", 
         RowBox[{"F", "[", "t", "]"}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l", " ", 
             SuperscriptBox["\[Theta]dot", "2"]}], "-", 
            RowBox[{"g", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
        RowBox[{"m", "+", "M", "-", 
         RowBox[{"m", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]},
      {"\[Theta]dot"},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"F", "[", "t", "]"}]}], "-", 
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "xdot"}], " ", "\[Eta]"}], "+", 
             RowBox[{"l", " ", "m", " ", 
              SuperscriptBox["\[Theta]dot", "2"], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "M", "-", 
            RowBox[{"m", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7759396173608313`*^9, {3.7766978075764627`*^9, 3.776697824839705*^9}, 
   3.776698466976297*^9, 3.776698519197209*^9, 3.776698566571485*^9, 
   3.776698603438901*^9, {3.776699271928549*^9, 3.776699299968464*^9}},
 CellLabel->
  "Out[96]//MatrixForm=",ExpressionUUID->"2d0f7c70-f782-45dd-a09a-\
a5b92e1a6a05"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"JacobianL", "[", 
   RowBox[{
   "x_", ",", "xdot_", ",", " ", "\[Theta]_", ",", " ", "\[Theta]dot_"}], 
   "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"StateL", "[", 
     RowBox[{
     "x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}], "]"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}], 
      "}"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.776697870684084*^9, 3.776697890585328*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"9dbdb8b2-5014-4287-b26b-7924b813860e"],

Cell["\<\
Find fixed points of the dynamics. Notice that when we plug in the fixed \
point, the only behavior that should remain is the external forcing (a fixed \
point makes the  force-less dynamics zero).\
\>", "Text",
 CellChangeTimes->{{3.77558897245704*^9, 3.7755889976766768`*^9}, {
  3.7758481724634447`*^9, 3.775848174501172*^9}, {3.7766981166018*^9, 
  3.776698191975992*^9}},ExpressionUUID->"7f32b84f-3bdd-4672-9fcc-\
47e81a774971"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StateL", "[", 
        RowBox[{
        "x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}], 
        "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F", "[", "t", "]"}], "\[Rule]", "0"}], "}"}]}], ")"}], 
     "\[Equal]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}], "}"}]}],
    "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"no", " ", "drive", " ", "force"}], ",", " ", 
    RowBox[{"x", " ", "unsolveable"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.775937453163473*^9, 3.775937539979369*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"8c46f169-80f0-4820-9c95-784bc541cdca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xdot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]dot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         TemplateBox[{"1"},
          "C"]}], ",", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xdot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]dot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          TemplateBox[{"1"},
           "C"]}]}], ",", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.776697819869317*^9, 3.77669782485964*^9}, 
   3.776697896090626*^9, 3.776698525093536*^9, 3.77669860892092*^9, 
   3.7766993027890053`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"9e6cd0dc-f475-4764-8e99-9eac81ff5443"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pt0L", " ", "=", " ", 
   RowBox[{
    RowBox[{"JacobianL", "[", 
     RowBox[{
     "x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}], "]"}],
     "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xdot", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]dot", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pt\[Pi]L", " ", "=", 
   RowBox[{
    RowBox[{"JacobianL", "[", 
     RowBox[{
     "x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}], "]"}],
     "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xdot", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]dot", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "\[Pi]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Pt0L", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateL", "[", 
    RowBox[{"x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}],
     "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xdot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]dot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", "0"}]}], "}"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateL", "[", 
    RowBox[{"x", ",", "xdot", ",", " ", "\[Theta]", ",", " ", "\[Theta]dot"}],
     "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xdot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]dot", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", "\[Pi]"}]}], "}"}]}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{
  3.775936223478756*^9, 3.7759362871211023`*^9, {3.7759376073161097`*^9, 
   3.775937662541225*^9}, {3.775939553610107*^9, 3.775939566550305*^9}, {
   3.776697929821528*^9, 3.776697933213924*^9}, {3.776697973782044*^9, 
   3.776697977468652*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"b67b53d2-27c8-44ae-b17a-e6c4197ff85e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[Eta]", "M"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"g", " ", "m"}], "M"]}], "0"},
     {"0", "0", "0", "1"},
     {"0", 
      FractionBox["\[Eta]", 
       RowBox[{"l", " ", "M"}]], 
      FractionBox[
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "M"}], ")"}]}], 
       RowBox[{"l", " ", "M"}]], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7759395670692263`*^9, {3.775939603271531*^9, 3.7759396255444593`*^9}, 
   3.7766978249037647`*^9, {3.776697904077724*^9, 3.7766979337956123`*^9}, {
   3.776697974450059*^9, 3.776697977999207*^9}, 3.7766985352157927`*^9, 
   3.776698611155991*^9, {3.7766992902959633`*^9, 3.776699304021837*^9}},
 CellLabel->
  "Out[101]//MatrixForm=",ExpressionUUID->"bfd77383-85e2-48e9-b48f-\
0a45dace6794"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       FractionBox[
        RowBox[{"F", "[", "t", "]"}], "M"]},
      {"0"},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"F", "[", "t", "]"}], 
         RowBox[{"l", " ", "M"}]]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7759395670692263`*^9, {3.775939603271531*^9, 3.7759396255444593`*^9}, 
   3.7766978249037647`*^9, {3.776697904077724*^9, 3.7766979337956123`*^9}, {
   3.776697974450059*^9, 3.776697977999207*^9}, 3.7766985352157927`*^9, 
   3.776698611155991*^9, {3.7766992902959633`*^9, 3.7766993040293293`*^9}},
 CellLabel->
  "Out[102]//MatrixForm=",ExpressionUUID->"ba39e1da-9274-4ce7-8ffc-\
4d7e814eb10c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       FractionBox[
        RowBox[{"F", "[", "t", "]"}], "M"]},
      {"0"},
      {
       FractionBox[
        RowBox[{"F", "[", "t", "]"}], 
        RowBox[{"l", " ", "M"}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7759395670692263`*^9, {3.775939603271531*^9, 3.7759396255444593`*^9}, 
   3.7766978249037647`*^9, {3.776697904077724*^9, 3.7766979337956123`*^9}, {
   3.776697974450059*^9, 3.776697977999207*^9}, 3.7766985352157927`*^9, 
   3.776698611155991*^9, {3.7766992902959633`*^9, 3.776699304030518*^9}},
 CellLabel->
  "Out[103]//MatrixForm=",ExpressionUUID->"74fccd51-8ac1-4b0c-80f0-\
824c1f9c8b7f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hamiltonian formulation", "Subsection",
 CellChangeTimes->{{3.775936094984932*^9, 3.7759361144931726`*^9}, {
  3.775939704937443*^9, 
  3.775939705898271*^9}},ExpressionUUID->"35d233a9-cdfe-4ee2-a21a-\
d990791d05ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d1", "[", "\[Theta]_", "]"}], ":=", 
  RowBox[{"m", " ", 
   SuperscriptBox["l", "2"], 
   RowBox[{"(", 
    RowBox[{"M", "+", 
     RowBox[{"m", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalH]", "[", 
   RowBox[{"x_", ",", "px_", ",", " ", "\[Theta]_", ",", " ", "p\[Theta]_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    SuperscriptBox["p\[Theta]", "2"], " ", 
    FractionBox[
     RowBox[{"M", "+", "m"}], 
     RowBox[{"d1", "[", "\[Theta]", "]"}]]}], "-", 
   RowBox[{
    FractionBox[
     RowBox[{"m", " ", "l", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
     RowBox[{"d1", "[", "\[Theta]", "]"}]], "p\[Theta]", " ", "px"}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    SuperscriptBox["px", "2"], " ", 
    FractionBox[
     RowBox[{"m", " ", 
      SuperscriptBox["l", "2"]}], 
     RowBox[{"d1", "[", "\[Theta]", "]"}]]}], "+", 
   RowBox[{"m", " ", "g", " ", "l", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.775585634538166*^9, 3.775585647766959*^9}, {
   3.775585723633955*^9, 3.7755857657271357`*^9}, {3.77558580422005*^9, 
   3.775585807556858*^9}, {3.775585884518412*^9, 3.7755858847070637`*^9}, {
   3.7755859271802464`*^9, 3.775585970436857*^9}, {3.775587082571316*^9, 
   3.775587084484099*^9}, {3.775588180461172*^9, 3.775588182100233*^9}, {
   3.7755888196545467`*^9, 3.775588821298753*^9}, {3.7758631932161903`*^9, 
   3.775863196347083*^9}, 3.775934527719358*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"91725b48-6f95-4be9-937e-7aa72a7200ac"],

Cell["\<\
Compute the equations of motion. In the Hamiltonian formulation, a \
first-order differential equation for the state is immediate.\
\>", "Text",
 CellChangeTimes->{{3.775587134000409*^9, 3.775587138130727*^9}, 
   3.775864068083851*^9, {3.775939970339785*^9, 
   3.775939994168683*^9}},ExpressionUUID->"e8de3db2-7176-4516-92b6-\
04233d1a183e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"StateH", "[", 
   RowBox[{"x_", ",", "px_", ",", "\[Theta]_", ",", "p\[Theta]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "px"], 
      RowBox[{"(", 
       RowBox[{"\[ScriptCapitalH]", "[", 
        RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}],
         "]"}], ")"}]}], ",", " ", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       RowBox[{"(", 
        RowBox[{"\[ScriptCapitalH]", "[", 
         RowBox[{
         "x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], "]"}],
         ")"}]}]}], ",", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p\[Theta]"], 
      RowBox[{"(", 
       RowBox[{"\[ScriptCapitalH]", "[", 
        RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}],
         "]"}], ")"}]}], ",", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Theta]"], 
       RowBox[{"(", 
        RowBox[{"\[ScriptCapitalH]", "[", 
         RowBox[{
         "x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], "]"}],
         ")"}]}]}]}], "}"}], "+", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"F", "[", "t", "]"}], "-", 
      RowBox[{"\[Eta]", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "px"], 
        RowBox[{"(", 
         RowBox[{"\[ScriptCapitalH]", "[", 
          RowBox[{
          "x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], 
          "]"}], ")"}]}]}]}], ",", "0", ",", "0"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StateH", "[", 
   RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], 
   "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.775586898897374*^9, 3.775587033355467*^9}, {
  3.77558714073524*^9, 3.7755871808624*^9}, {3.7755878004424677`*^9, 
  3.775587801240819*^9}, {3.775934533520629*^9, 3.775934536770658*^9}, {
  3.7759368545959463`*^9, 3.775936858140812*^9}, {3.7759370483708277`*^9, 
  3.77593704938408*^9}, {3.775937084297751*^9, 3.775937128512187*^9}, {
  3.77593971570018*^9, 3.7759397158142557`*^9}, {3.7759412495791273`*^9, 
  3.7759412788190117`*^9}, {3.775941333375978*^9, 3.7759413502174187`*^9}},
 NumberMarks->False,
 CellLabel->"In[21]:=",ExpressionUUID->"8a059d9f-5cbb-47c1-a5de-2f36ec5b5b43"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox["px", 
         RowBox[{"M", "+", 
          RowBox[{"m", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]], "-", 
        FractionBox[
         RowBox[{"p\[Theta]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}]},
      {
       RowBox[{
        RowBox[{"F", "[", "t", "]"}], "-", 
        RowBox[{"\[Eta]", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["px", 
            RowBox[{"M", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]], "-", 
           FractionBox[
            RowBox[{"p\[Theta]", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
            RowBox[{"l", " ", 
             RowBox[{"(", 
              RowBox[{"M", "+", 
               RowBox[{"m", " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}], 
          ")"}]}]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "+", "M"}], ")"}], " ", "p\[Theta]"}], 
         RowBox[{
          SuperscriptBox["l", "2"], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], "-", 
        
        FractionBox[
         RowBox[{"px", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}]},
      {
       RowBox[{
        RowBox[{"g", " ", "l", " ", "m", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
        FractionBox[
         RowBox[{"m", " ", 
          SuperscriptBox["px", "2"], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "2"]], 
        "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "+", "M"}], ")"}], " ", 
          SuperscriptBox["p\[Theta]", "2"], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          SuperscriptBox["l", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"M", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
           "2"]}]], "-", 
        FractionBox[
         RowBox[{"2", " ", "m", " ", "px", " ", "p\[Theta]", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{"l", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"M", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
           "2"]}]], "-", 
        FractionBox[
         RowBox[{"px", " ", "p\[Theta]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{"M", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7759397201319427`*^9, {3.775941330071631*^9, 3.77594135228214*^9}, 
   3.77669782493305*^9},
 CellLabel->
  "Out[22]//MatrixForm=",ExpressionUUID->"6bd63075-8333-4263-9f9c-\
816163e3baad"]
}, Open  ]],

Cell["Find fixed points of the dynamics.", "Text",
 CellChangeTimes->{{3.77558897245704*^9, 3.7755889976766768`*^9}, {
  3.7758481724634447`*^9, 
  3.775848174501172*^9}},ExpressionUUID->"ab68ef59-2b75-430b-81da-\
851952cfbba1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StateH", "[", 
        RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}],
         "]"}], "/.", 
       RowBox[{
        RowBox[{"F", "[", "t", "]"}], "\[Rule]", "0"}]}], ")"}], "\[Equal]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], "}"}]}], 
   "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"x", " ", "is", " ", "unsolveable"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.775937321044813*^9, 3.7759373792970753`*^9}, {
  3.775941374292117*^9, 3.775941382652565*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"da518cc6-f91d-436f-92c5-4c7f569f0f84"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"px", "\[Rule]", "0"}], ",", 
     RowBox[{"p\[Theta]", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
         TemplateBox[{"1"},
          "C"]}], ",", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"px", "\[Rule]", "0"}], ",", 
     RowBox[{"p\[Theta]", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          TemplateBox[{"1"},
           "C"]}]}], ",", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}], "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7759373424064207`*^9, 3.775937370250717*^9}, 
   3.775939723967299*^9, {3.7759413672943583`*^9, 3.77594138314979*^9}, 
   3.776697825493745*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"183b3ebd-1dc5-4992-a16f-deea387f30d5"]
}, Open  ]],

Cell["\<\
Compute the Jacobian and evaluate at the fixed points. Linearize the system \
and inspect the forcing. Notice that the forcing is more straight-forward in \
the Hamiltonian formalism in contrast to the Lagrangian formalism.\
\>", "Text",
 CellChangeTimes->{{3.775588547372367*^9, 3.7755885656348352`*^9}, {
  3.775588966214305*^9, 3.775588967494576*^9}, {3.775939778569097*^9, 
  3.775939783406693*^9}, {3.77594410530993*^9, 
  3.775944161648571*^9}},ExpressionUUID->"23707189-39a8-47e1-a9d9-\
98953646858e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JacobianH", "[", 
   RowBox[{"x_", ",", "px_", ",", " ", "\[Theta]_", ",", " ", "p\[Theta]_"}], 
   "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"StateH", "[", 
     RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], 
      "}"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.775587190521291*^9, 3.775587203107657*^9}, {
  3.775587290019113*^9, 3.775587456822205*^9}, {3.775937563156687*^9, 
  3.77593759034107*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"99ab40f2-70e7-4b52-a2d2-031d03e1a094"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pt0H", " ", "=", " ", 
   RowBox[{
    RowBox[{"JacobianH", "[", 
     RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], 
     "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"px", "\[Rule]", "0"}], ",", 
      RowBox[{"p\[Theta]", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pt\[Pi]H", " ", "=", 
   RowBox[{
    RowBox[{"JacobianH", "[", 
     RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], 
     "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"px", "\[Rule]", "0"}], ",", 
      RowBox[{"p\[Theta]", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "\[Pi]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Pt0H", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateH", "[", 
    RowBox[{"x", ",", "px", ",", " ", "\[Theta]", ",", " ", "p\[Theta]"}], 
    "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"px", "\[Rule]", "0"}], ",", 
     RowBox[{"p\[Theta]", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", "0"}]}], "}"}]}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.775587464408382*^9, 3.775587471650683*^9}, {
   3.7755875299265547`*^9, 3.77558757026381*^9}, {3.7755893618085814`*^9, 
   3.7755893803795357`*^9}, {3.775589733563175*^9, 3.7755897414041348`*^9}, {
   3.775590404251068*^9, 3.775590436661047*^9}, {3.775590586959916*^9, 
   3.775590589349086*^9}, {3.7755906366941843`*^9, 3.775590637096773*^9}, {
   3.7758495517761173`*^9, 3.7758495665602217`*^9}, {3.775937570151003*^9, 
   3.7759375717834587`*^9}, {3.77594140077566*^9, 3.775941417750072*^9}, {
   3.7759415252463837`*^9, 3.7759415295442543`*^9}, 3.7759437441806107`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"52d479a8-ee0f-4342-8a34-600d1f89b7fc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "M"], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"l", " ", "M"}]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[Eta]", "M"]}], "0", 
      FractionBox["\[Eta]", 
       RowBox[{"l", " ", "M"}]]},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"l", " ", "M"}]]}], "0", 
      FractionBox[
       RowBox[{"m", "+", "M"}], 
       RowBox[{
        SuperscriptBox["l", "2"], " ", "m", " ", "M"}]]},
     {"0", "0", 
      RowBox[{"g", " ", "l", " ", "m"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.77559063756357*^9, 3.775836740541164*^9, 3.7758495670971813`*^9, {
   3.775937574558319*^9, 3.775937593284244*^9}, {3.775941390221767*^9, 
   3.775941418050725*^9}, 3.77594153169911*^9, 3.775943747924074*^9, 
   3.7766978255255823`*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"e5894b5e-88c1-4185-81d8-\
547412b13667"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{"F", "[", "t", "]"}]},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.77559063756357*^9, 3.775836740541164*^9, 3.7758495670971813`*^9, {
   3.775937574558319*^9, 3.775937593284244*^9}, {3.775941390221767*^9, 
   3.775941418050725*^9}, 3.77594153169911*^9, 3.775943747924074*^9, 
   3.776697825527337*^9},
 CellLabel->
  "Out[28]//MatrixForm=",ExpressionUUID->"87cabdbc-1602-4dd4-8240-\
7de58cabb5d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"Pt0H", "/.", 
    RowBox[{"{", 
     RowBox[{"\[Eta]", "\[Rule]", "0"}], "}"}]}], "]"}], "//", "Simplify", 
  RowBox[{"(*", 
   RowBox[{"Frictionless", " ", "for", " ", 
    RowBox[{"simplictiy", "--"}], 
    RowBox[{"Unstable", "!"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7759424531343517`*^9, 3.775942485670623*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"9cc796e1-95ee-4f52-95e6-2f10bc4322c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"-", 
    SqrtBox[
     FractionBox[
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", "M"}], ")"}]}], 
      RowBox[{"l", " ", "M"}]]]}], ",", 
   SqrtBox[
    FractionBox[
     RowBox[{"g", " ", 
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}]}], 
     RowBox[{"l", " ", "M"}]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.7759424633768044`*^9, 3.775942487116568*^9}, 
   3.776697825549033*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"e706b76b-9223-43b6-bc21-19d0878eaa9a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Control Theory in Hamiltonian Formalism", "Subsection",
 CellChangeTimes->{{3.7759425000710907`*^9, 
  3.775942508304261*^9}},ExpressionUUID->"6ee97955-3818-47d9-ba16-\
8f49a73f7318"],

Cell["Compute the controllability matrix.", "Text",
 CellChangeTimes->{{3.775837866323488*^9, 3.775837912807674*^9}, {
  3.775847762775359*^9, 
  3.775847763051196*^9}},ExpressionUUID->"94ad15d6-e232-4133-8cb3-\
76ea676c5c20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ControlMatrix", "[", 
   RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", "=", " ", "A"}], ",", " ", 
      RowBox[{"b", "=", "B"}], ",", "n", ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "Pt0H", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", ".", "b"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"NestList", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"Id", ",", 
              RowBox[{"a", ".", "Id"}]}], "]"}], ",", " ", 
            RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "//", "Transpose"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "res"}], " ", "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "1"}], "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.775834359932541*^9, 3.775834433442768*^9}, {
   3.775834484036553*^9, 3.775834494806436*^9}, {3.775834535043972*^9, 
   3.775834563150395*^9}, {3.775834628887203*^9, 3.7758346342690372`*^9}, {
   3.775834793097039*^9, 3.775834906773838*^9}, {3.77583494381444*^9, 
   3.775834946334195*^9}, {3.775834976782074*^9, 3.775835005243482*^9}, {
   3.775835104826902*^9, 3.775835110449265*^9}, {3.775835147227088*^9, 
   3.775835176337859*^9}, 3.775835208038714*^9, {3.775835265902989*^9, 
   3.775835374527603*^9}, {3.7758354548167353`*^9, 3.775835499628242*^9}, {
   3.775835530461316*^9, 3.775835534699294*^9}, {3.775835650550893*^9, 
   3.775835719565485*^9}, {3.775835783262175*^9, 3.7758358057198277`*^9}, {
   3.77583587235954*^9, 3.775835919407353*^9}, {3.775836030706964*^9, 
   3.7758361016273813`*^9}, 3.7758362672041063`*^9, 3.7759425141672983`*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"6dbbe2e2-0a73-4699-8691-6de5955ad85f"],

Cell["\<\
Look at an example. We\[CloseCurlyQuote]ll study the most controllable \
directions using the controllability Gramian.\
\>", "Text",
 CellChangeTimes->{{3.77584745012929*^9, 3.775847453511671*^9}, {
  3.775847744856288*^9, 3.775847754548595*^9}, {3.77584804333552*^9, 
  3.775848067751532*^9}, {3.7758482060833282`*^9, 3.775848206229784*^9}, {
  3.775942579100431*^9, 
  3.775942582267243*^9}},ExpressionUUID->"79b350d5-6430-4bd2-a004-\
a814f92c846a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"example", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Eta]", "\[Rule]", "1"}], ",", 
     RowBox[{"l", "\[Rule]", "2"}], ",", 
     RowBox[{"g", "\[Rule]", 
      RowBox[{"-", "10"}]}], ",", 
     RowBox[{"M", "\[Rule]", "5"}], ",", 
     RowBox[{"m", "\[Rule]", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"c", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"ControlMatrix", "[", 
     RowBox[{"Pt0H", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}]}], "}"}]}], "]"}], "/.", "example"}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "s", ",", "v"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", 
    RowBox[{"c", ".", 
     RowBox[{"Transpose", "[", "c", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.775835501368126*^9, 3.775835512426578*^9}, {
   3.775835544242393*^9, 3.775835573064603*^9}, 3.775835891275364*^9, {
   3.775835928916624*^9, 3.775836015225157*^9}, 3.775836057339972*^9, {
   3.775836105780821*^9, 3.775836151209888*^9}, {3.7758362052243767`*^9, 
   3.775836250229459*^9}, {3.775836778895417*^9, 3.7758368009726686`*^9}, 
   3.775836873705092*^9, 3.775837278654142*^9, {3.775837701404216*^9, 
   3.775837710042741*^9}, 3.775837891666251*^9, 3.775839323300012*^9, {
   3.775847303937697*^9, 3.775847352011649*^9}, {3.7758474641601667`*^9, 
   3.7758474742108583`*^9}, {3.775847742128327*^9, 3.775847828378396*^9}, {
   3.775847953982799*^9, 3.775848018174494*^9}, 3.775849697783976*^9, {
   3.775941624976137*^9, 3.775941666917203*^9}, 3.775942445046102*^9, {
   3.775942526086258*^9, 3.7759425595383263`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"fe9accd9-a77e-470d-9c34-00d17da4efe1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.2`", ",", 
     RowBox[{"-", "0.04`"}], ",", 
     RowBox[{"-", "0.192`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.2`"}], ",", "0.04`", ",", "0.192`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.1`"}], ",", "0.02`", ",", "0.596`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "2.`", ",", 
     RowBox[{"-", "0.4`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.775942545381691*^9, 3.775942560435133*^9}, 
   3.776697825888687*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"4177d54e-c36a-48c8-aa7b-48a27b821e43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "c", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Diagonal", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.775837950122154*^9, 3.775837983933453*^9}, {
   3.7758392125967617`*^9, 3.7758392126703157`*^9}, {3.7758392932597847`*^9, 
   3.7758393146849957`*^9}, {3.775847378856381*^9, 3.7758473924029922`*^9}, 
   3.775847447196069*^9, {3.7758474845148163`*^9, 3.775847499222838*^9}, {
   3.7758478323579597`*^9, 3.77584786089324*^9}, {3.775848218720668*^9, 
   3.775848230870578*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"d74ab764-41eb-4ff9-b069-c7e75251ffcc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.0009670516003726337`"}], "0.09913316371799173`", 
      RowBox[{"-", "0.35623440372931253`"}], "0.9291225593333129`"},
     {"0.001272081104172864`", 
      RowBox[{"-", "0.976389319969007`"}], 
      RowBox[{"-", "0.21491397021956565`"}], "0.021777581697409797`"},
     {"0.052154056497844895`", 
      RowBox[{"-", "0.1915927623916628`"}], "0.9081041010046749`", 
      "0.3686720894351008`"},
     {
      RowBox[{"-", "0.9986377726741992`"}], 
      RowBox[{"-", "0.011345708477343506`"}], "0.04749712351897212`", 
      "0.0183819788076371`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.77584748919726*^9, 3.775847500066999*^9}, {
   3.775847837721385*^9, 3.775847861587577*^9}, {3.7758479710416193`*^9, 
   3.7758479775784483`*^9}, {3.7758480147921543`*^9, 3.775848022520268*^9}, 
   3.77584821963933*^9, 3.775848253479322*^9, 3.775849700444985*^9, 
   3.775942562467794*^9, 3.776697826042365*^9},
 CellLabel->
  "Out[34]//MatrixForm=",ExpressionUUID->"9afe360f-533a-48b5-83eb-\
c022459dca03"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.77584748919726*^9, 3.775847500066999*^9}, {
   3.775847837721385*^9, 3.775847861587577*^9}, {3.7758479710416193`*^9, 
   3.7758479775784483`*^9}, {3.7758480147921543`*^9, 3.775848022520268*^9}, 
   3.77584821963933*^9, 3.775848253479322*^9, 3.775849700444985*^9, 
   3.775942562467794*^9, 3.776697826044662*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"267205de-b869-4034-9f19-9a885d34ac51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.170354304501048`", ",", "1.1130036683260682`", ",", 
   "0.3762839570629712`", ",", "0.022902070109911167`"}], "}"}]], "Output",
 CellChangeTimes->{{3.77584748919726*^9, 3.775847500066999*^9}, {
   3.775847837721385*^9, 3.775847861587577*^9}, {3.7758479710416193`*^9, 
   3.7758479775784483`*^9}, {3.7758480147921543`*^9, 3.775848022520268*^9}, 
   3.77584821963933*^9, 3.775848253479322*^9, 3.775849700444985*^9, 
   3.775942562467794*^9, 3.776697826046122*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"1ab8d8e7-f1b6-474a-858b-8aadd6b8fb85"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1533, 845},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
SpellingDictionaries->{"CorrectWords"->{
 "cartpole", "Gramian", "xdot", "\[Theta]dot"}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 777, 21, 39, "Input",ExpressionUUID->"430e562f-2b6c-4ec0-9302-4186201297f2"],
Cell[1338, 43, 3130, 74, 305, "Text",ExpressionUUID->"ea78d738-7d98-4393-9e5e-568137be42bc"],
Cell[CellGroupData[{
Cell[4493, 121, 170, 3, 69, "Subsection",ExpressionUUID->"8ee5324f-d8cd-4a8b-a841-d26519466c10"],
Cell[4666, 126, 1045, 24, 68, "Input",ExpressionUUID->"0773fa27-68e4-4548-9646-fc0005e7688d"],
Cell[5714, 152, 1137, 32, 79, "Text",ExpressionUUID->"a0ce988f-67a9-47bf-b257-3eb1dce7150a"],
Cell[CellGroupData[{
Cell[6876, 188, 4141, 104, 106, "Input",ExpressionUUID->"3cd99b9c-cd7f-4c30-9544-2252376c4807"],
Cell[11020, 294, 2364, 63, 80, "Output",ExpressionUUID->"056998f0-5e4a-4a11-a3e9-0b4472ff4f84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13421, 362, 1467, 30, 69, "Input",ExpressionUUID->"a5a25a67-e544-4067-b9ec-898e2a7842e4"],
Cell[14891, 394, 2451, 68, 196, "Output",ExpressionUUID->"2d0f7c70-f782-45dd-a09a-a5b92e1a6a05"]
}, Open  ]],
Cell[17357, 465, 633, 18, 39, "Input",ExpressionUUID->"9dbdb8b2-5014-4287-b26b-7924b813860e"],
Cell[17993, 485, 443, 8, 75, "Text",ExpressionUUID->"7f32b84f-3bdd-4672-9fcc-47e81a774971"],
Cell[CellGroupData[{
Cell[18461, 497, 871, 25, 39, "Input",ExpressionUUID->"8c46f169-80f0-4820-9c95-784bc541cdca"],
Cell[19335, 524, 1270, 37, 44, "Output",ExpressionUUID->"9e6cd0dc-f475-4764-8e99-9eac81ff5443"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20642, 566, 1997, 55, 156, "Input",ExpressionUUID->"b67b53d2-27c8-44ae-b17a-e6c4197ff85e"],
Cell[22642, 623, 1300, 37, 156, "Output",ExpressionUUID->"bfd77383-85e2-48e9-b48f-0a45dace6794"],
Cell[23945, 662, 1141, 33, 158, "Output",ExpressionUUID->"ba39e1da-9274-4ce7-8ffc-4d7e814eb10c"],
Cell[25089, 697, 1113, 32, 191, "Output",ExpressionUUID->"74fccd51-8ac1-4b0c-80f0-824c1f9c8b7f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26251, 735, 222, 4, 69, "Subsection",ExpressionUUID->"35d233a9-cdfe-4ee2-a21a-d990791d05ab"],
Cell[26476, 741, 1705, 43, 106, "Input",ExpressionUUID->"91725b48-6f95-4be9-937e-7aa72a7200ac"],
Cell[28184, 786, 353, 7, 45, "Text",ExpressionUUID->"e8de3db2-7176-4516-92b6-04233d1a183e"],
Cell[CellGroupData[{
Cell[28562, 797, 2381, 60, 106, "Input",ExpressionUUID->"8a059d9f-5cbb-47c1-a5de-2f36ec5b5b43"],
Cell[30946, 859, 4658, 135, 240, "Output",ExpressionUUID->"6bd63075-8333-4263-9f9c-816163e3baad"]
}, Open  ]],
Cell[35619, 997, 228, 4, 45, "Text",ExpressionUUID->"ab68ef59-2b75-430b-81da-851952cfbba1"],
Cell[CellGroupData[{
Cell[35872, 1005, 811, 21, 39, "Input",ExpressionUUID->"da518cc6-f91d-436f-92c5-4c7f569f0f84"],
Cell[36686, 1028, 1267, 37, 44, "Output",ExpressionUUID->"183b3ebd-1dc5-4992-a16f-deea387f30d5"]
}, Open  ]],
Cell[37968, 1068, 518, 9, 75, "Text",ExpressionUUID->"23707189-39a8-47e1-a9d9-98953646858e"],
Cell[38489, 1079, 702, 17, 39, "Input",ExpressionUUID->"99ab40f2-70e7-4b52-a2d2-031d03e1a094"],
Cell[CellGroupData[{
Cell[39216, 1100, 1912, 45, 127, "Input",ExpressionUUID->"52d479a8-ee0f-4342-8a34-600d1f89b7fc"],
Cell[41131, 1147, 1361, 41, 167, "Output",ExpressionUUID->"e5894b5e-88c1-4185-81d8-547412b13667"],
Cell[42495, 1190, 936, 28, 132, "Output",ExpressionUUID->"87cabdbc-1602-4dd4-8240-7de58cabb5d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43468, 1223, 471, 11, 39, "Input",ExpressionUUID->"9cc796e1-95ee-4f52-95e6-2f10bc4322c0"],
Cell[43942, 1236, 577, 18, 78, "Output",ExpressionUUID->"e706b76b-9223-43b6-bc21-19d0878eaa9a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44568, 1260, 189, 3, 69, "Subsection",ExpressionUUID->"6ee97955-3818-47d9-ba16-8f49a73f7318"],
Cell[44760, 1265, 226, 4, 45, "Text",ExpressionUUID->"94ad15d6-e232-4133-8cb3-76ea676c5c20"],
Cell[44989, 1271, 2311, 51, 127, "Input",ExpressionUUID->"6dbbe2e2-0a73-4699-8691-6de5955ad85f"],
Cell[47303, 1324, 461, 9, 45, "Text",ExpressionUUID->"79b350d5-6430-4bd2-a004-a814f92c846a"],
Cell[CellGroupData[{
Cell[47789, 1337, 1905, 42, 98, "Input",ExpressionUUID->"fe9accd9-a77e-470d-9c34-00d17da4efe1"],
Cell[49697, 1381, 696, 18, 44, "Output",ExpressionUUID->"4177d54e-c36a-48c8-aa7b-48a27b821e43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50430, 1404, 663, 10, 98, "Input",ExpressionUUID->"d74ab764-41eb-4ff9-b069-c7e75251ffcc"],
Cell[51096, 1416, 1456, 34, 132, "Output",ExpressionUUID->"9afe360f-533a-48b5-83eb-c022459dca03"],
Cell[52555, 1452, 441, 6, 44, "Output",ExpressionUUID->"267205de-b869-4034-9f19-9a885d34ac51"],
Cell[52999, 1460, 586, 10, 44, "Output",ExpressionUUID->"1ab8d8e7-f1b6-474a-858b-8aadd6b8fb85"]
}, Open  ]]
}, Open  ]]
}
]
*)

